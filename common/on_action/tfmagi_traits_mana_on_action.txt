
tfmagi_traits_start_register = {
	effect = {
		every_living_character = {
			if = {
				limit = {
					has_trait = tfmagi_mage
				}
				add_tfmagi_mage_trait = yes
			}
		}
	}
}

tfmagi_mages_ongoing = {
	effect = {
		every_in_global_list = {
			variable = tfmagi_mages_global_list
			if = {
				limit = {
					NAND = {
						is_alive = yes
						has_trait = tfmagi_mage
					}
				}
				remove_list_global_variable = {
					name = tfmagi_mages_global_list
					target = THIS
				}
			}
			else = {
				add_trait_xp = {
					trait = tfmagi_mage
					track = tfmagi_mage_mana
					value = tfmagi_mana_gain_monthly_amount
				}
			}
			
		}
	}
}

tfmagi_traits_recursive_monthly = {
	on_actions = {
		tfmagi_mages_ongoing
		
		delay = { months = 1 }
		tfmagi_traits_recursive_monthly
	}
}

on_game_start_after_lobby = {
	on_actions = {
		tfmagi_traits_start_register
		tfmagi_traits_recursive_monthly
	}
}
